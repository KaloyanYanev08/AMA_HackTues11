{% extends 'base.html' %}

{% block content %}
<div class="flex items-center justify-center">
    <div class="card flex-shrink-0 w-full max-w-lg shadow-2xl bg-base-100 mt-15">
        <form method="POST" action="#" class="card-body">
            {{ form.hidden_tag() }}
            <span class="text-2xl font-bold text-center">Create Schedule</span>
            <div class="tabs tabs-box">
                {% for day in ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'] %}
                    <input type="radio" name="day_tabs" class="tab" aria-label="{{ day }}" id="tab-{{ day }}" {% if loop.first %}checked="checked"{% endif %} />
                    <div class="tab-content bg-base-100 border-base-300 p-6" id="content-{{ day }}">
                        <h3 class="text-xl font-bold">Activities for {{ day }}</h3>
                        {% for activity in form.activities %}
                        <div class="form-control">
                            {{ activity.details.label(class="label-text") }}
                            {{ activity.details(class="input input-bordered", id="activities-{{ loop.index0 }}-details") }}
                        </div>
                        <div class="form-control">
                            {{ activity.start_time.label(class="label-text") }}
                            {{ activity.start_time(class="input input-bordered", id="activities-{{ loop.index0 }}-start_time") }}
                        </div>
                        <div class="form-control">
                            {{ activity.end_time.label(class="label-text") }}
                            {{ activity.end_time(class="input input-bordered", id="activities-{{ loop.index0 }}-end_time") }}
                        </div>
                        <div class="form-control">
                            {{ activity.day_of_week(class="hidden", value=day) }}
                        </div>
                        <hr class="my-4">
                        {% endfor %}
                    </div>
                {% endfor %}
            </div>
            <div class="form-control mt-6">
                {{ form.add_more(class="btn btn-secondary") }}
                {{ form.submit(class="btn btn-primary") }}
            </div>
        </form>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const tabs = document.querySelectorAll('[name="day_tabs"]');
        const tabContents = document.querySelectorAll('.tab-content');
        const formControls = document.querySelectorAll('.form-control input, .form-control select');

        const updateFormControls = () => {
            tabContents.forEach(content => {
                const isVisible = !content.classList.contains('hidden');
                content.querySelectorAll('input, select').forEach(input => {
                    input.disabled = !isVisible;
                });
            });
        };

        tabs.forEach(tab => {
            tab.addEventListener('change', () => {
                tabContents.forEach(content => content.classList.add('hidden'));
                const activeTab = document.querySelector(`#content-${tab.getAttribute('aria-label')}`);
                if (activeTab) {
                    activeTab.classList.remove('hidden');
                }
                updateFormControls();
            });
        });

        // Initialize the first tab as visible
        const firstTab = document.querySelector('[name="day_tabs"]:checked');
        if (firstTab) {
            const activeTab = document.querySelector(`#content-${firstTab.getAttribute('aria-label')}`);
            if (activeTab) {
                activeTab.classList.remove('hidden');
            }
        }
        updateFormControls();
    });
</script>
{% endblock %}
